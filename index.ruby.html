<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<meta name="author" content="Matt Wynne">
<title>BDD with Cucumber (Ruby)</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>BDD with Cucumber (Ruby)</h1>
<div class="details">
<span id="author" class="author">Matt Wynne</span><br>
<span id="email" class="email"><a href="mailto:matt@cucumber.io">matt@cucumber.io</a></span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_discovering_bdd">1. Discovering BDD</a></li>
<li><a href="#_your_first_scenario">2. Your first Scenario</a>
<ul class="sectlevel2">
<li><a href="#_an_introduction_to_shouty">2.1. An introduction to Shouty</a></li>
<li><a href="#_choose_the_first_scenario">2.2. Choose the first scenario</a></li>
<li><a href="#_install_cucumber">2.3. Install Cucumber</a></li>
<li><a href="#_add_a_scenario_wire_it_up">2.4. Add a scenario, wire it up</a></li>
<li><a href="#_sketch_out_the_solution">2.5. Sketch out the solution</a></li>
<li><a href="#_make_the_scenario_pass">2.6. Make the scenario pass</a></li>
</ul>
</li>
<li><a href="#_expressing_yourself">3. Expressing yourself</a>
<ul class="sectlevel2">
<li><a href="#_cucumber_expressions_not_regular_expressions">3.1. Cucumber expressions not regular expressions</a></li>
<li><a href="#_literal_expressions">3.2. Literal expressions</a></li>
<li><a href="#_capturing_parameters">3.3. Capturing parameters</a></li>
<li><a href="#_flexibility">3.4. Flexibility</a></li>
<li><a href="#_custom_parameters">3.5. Custom parameters</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_discovering_bdd">1. Discovering BDD</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The script for this chapter is currently in <a href="https://docs.google.com/document/d/1S8eX3lz8-Ys9v94id9atFcX70hpi6XUoBaE5d6jsbHs/edit">Google Docs</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_your_first_scenario">2. Your first Scenario</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The video and audio assets for this chapter are <a href="https://drive.google.com/drive/u/2/folders/1He7stdn0S-zIlNmWF-d1ISuyhfC7tMwO">here</a>.</p>
</div>
<div class="sect2">
<h3 id="_an_introduction_to_shouty">2.1. An introduction to Shouty</h3>
<div class="audioblock">
<div class="content">
<audio src="02.01.audio.mp3" controls>
Your browser does not support the audio tag.
</audio>
</div>
</div>
<div class="videoblock">
<div class="content">
<video src="https://drive.google.com/uc?id=1coTuZC_HcN3RXfduRqnZMfzlYJStQ2hq" controls>
Your browser does not support the video tag.
</video>
</div>
</div>
<div class="paragraph">
<p>Shouty is a social network that allows people who are physically close to communicate, just like people have always communicated with their voices. In the real world you can talk to someone in the same room, or across the street. Or even 100 m away from you in a park - if you shout.</p>
</div>
<div class="paragraph">
<p>That’s Shouty. What you say on this social network can only be “heard” by people who are nearby.</p>
</div>
</div>
<div class="sect2">
<h3 id="_choose_the_first_scenario">2.2. Choose the first scenario</h3>
<div class="audioblock">
<div class="content">
<audio src="02.02.audio.mp3" controls>
Your browser does not support the audio tag.
</audio>
</div>
</div>
<div class="videoblock">
<div class="content">
<video src="02.02.animation.mp4" controls>
Your browser does not support the video tag.
</video>
</div>
</div>
<div class="paragraph">
<p>Let’s start with a very basic example of Shouty’s behaviour. Something we might have discussed in a three amigos meeting:</p>
</div>
<div class="paragraph">
<p>Sean the shouter shouts "free bagels at Sean&#8217;s" and Lucy the listener who happens to be stood across the street from his store, 15 metres away, hears him. She walks into Sean’s Coffee and takes advantage of the offer.</p>
</div>
<div class="paragraph">
<p><span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 1</span>
We can translate this into a Gherkin scenario so that Cucumber can run it. Here&#8217;s how that would look.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin"><span class="kn">Scenario</span><span class="p">:</span> Listener is within range
  <span class="nf">Given </span>Lucy is located 15m from Sean
  <span class="nf">When </span>Sean shouts <span class="s">"free bagels at Sean's"</span>
  <span class="nf">Then </span>Lucy hears Sean’s message</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can see there are four special keywords being used here. <code>Scenario</code> just tells Cucumber we’re about to describe an example that it can execute. Then you see the lines beginning with Given, When and Then.</p>
</div>
<div class="paragraph">
<p><span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 2</span>
<code>Given</code> is the context for the scenario. We’re putting the system into a specific state, ready for the scenario to unfold.</p>
</div>
<div class="paragraph">
<p><span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 3</span>
<code>When</code> is an action. Something that happens to the system that will cause something else to happen: an outcome.</p>
</div>
<div class="paragraph">
<p><span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 4</span>
<code>Then</code> is the outcome. It’s the behaviour we expect from the system when this action happens in this context.</p>
</div>
<div class="paragraph">
<p>You’ll notice we’ve omitted from our outcome anything about Lucy walking into Sean’s store and making a purchase. Remember, Gherkin is supposed to describe the behaviour of the system, so it would be distracting to have it in our scenario.</p>
</div>
<div class="paragraph">
<p>Each scenario has these three ingredients:
<span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 5</span>
  a context,
<span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 6</span>
  an action,
<span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 7</span>
  and one or more outcomes.</p>
</div>
<div class="paragraph">
<p>Together, they describe one single aspect of the behaviour of the system. An example.</p>
</div>
<div class="paragraph">
<p>Now that we’ve translated our example into Gherkin, we can automate it!</p>
</div>
</div>
<div class="sect2">
<h3 id="_install_cucumber">2.3. Install Cucumber</h3>
<div class="audioblock">
<div class="content">
<audio src="02.03.ruby.audio.mp3" controls>
Your browser does not support the audio tag.
</audio>
</div>
</div>
<div class="paragraph">
<p>Before we get started make sure you have a modern version of Ruby installed,
and the Bundler gem. Open a command-prompt and check the Ruby version, <span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 1</span> and the version of Bundler, Ruby&#8217;s package manager: <span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 2</span></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span>ruby <span class="nt">-v</span>
<span class="nv">$ </span>bundle <span class="nt">-v</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If you see an error message when you run these commands, you’ll need to fix your Ruby installation.</p>
</div>
<div class="paragraph">
<p><span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 3</span>
Go back to the command prompt and create a new directory for our project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span><span class="nb">mkdir </span>shouty</code></pre>
</div>
</div>
<div class="paragraph">
<p>Use <code>cd</code> to go into that directory. <span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 4</span> If you want to, you can open the directory up in your favourite text exitor at this point.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span><span class="nb">cd </span>shouty</code></pre>
</div>
</div>
<div class="paragraph">
<p><span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 5</span> <span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 6</span>
First we’ll create a Gemfile that describes the Ruby gems we need for our project.
<span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 7</span> We’ll add Cucumber and <span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 8</span> RSpec-Expectations.</p>
</div>
<div class="listingblock">
<div class="title">Gemfile</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="n">source</span> <span class="s2">"https://rubygems.org"</span>

<span class="n">gem</span> <span class="s1">'cucumber'</span>
<span class="n">gem</span> <span class="s1">'rspec'</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now go back to the command-line <span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 9</span> and run <code>bundle install</code> to install those gems.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span>bundle <span class="nb">install</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now we’re ready! If we run <code>cucumber</code> at this point <span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 10</span>, we’ll see it’s telling us to create a features directory.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span>bundle <span class="nb">exec </span>cucumber
No such file or directory - features. You can use <span class="sb">`</span>cucumber <span class="nt">--init</span><span class="sb">`</span> to get started.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Good, we&#8217;ve installed Cucumber.</p>
</div>
<div class="paragraph">
<p><span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 11</span>
As instructed, we can use the <code>cucumber --init</code> command to create the conventional folder structure for our Gherkin specifications and the code that will let Cucumber test them:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span>cucumber <span class="nt">--init</span>
  create   features
  create   features/step_definitions
  create   features/support
  create   features/support/env.rb</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now we’re ready to create our first feature file.</p>
</div>
<div class="paragraph">
<p><span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 12</span></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span>bundle <span class="nb">exec </span>cucumber
0 scenarios
0 steps
0m0.000s</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_add_a_scenario_wire_it_up">2.4. Add a scenario, wire it up</h3>
<div class="audioblock">
<div class="content">
<audio src="02.04.ruby.audio.mp3" controls>
Your browser does not support the audio tag.
</audio>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s create our first feature file. Call the file <code>hear_shout.feature</code> <span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 1</span></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span><span class="nb">touch </span>features/hear_shout.feature</code></pre>
</div>
</div>
<div class="paragraph">
<p><span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 2</span>
All feature files start with the keyword <code>Feature:</code>
<span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 3</span>
followed by a name.
It’s a good convention to give it a name that matches the file name.</p>
</div>
<div class="paragraph">
<p><span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 4</span>
Now let’s write out our first scenario.</p>
</div>
<div class="listingblock">
<div class="title">hear_shout.feature</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin"><span class="kd">Feature</span><span class="p">:</span> Hear shout
  <span class="kn">Scenario</span><span class="p">:</span> Listener is within range
    <span class="nf">Given </span>Lucy is located 15m from Sean
    <span class="nf">When </span>Sean shouts <span class="s">"free bagels at Sean's"</span>
    <span class="nf">Then </span>Lucy hears Sean’s message</code></pre>
</div>
</div>
<div class="paragraph">
<p>Save the file, switch back to the command-prompt <span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 5</span> and run
<code>cucumber</code>. <span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 6</span></p>
</div>
<div class="paragraph">
<p>You’ll see Cucumber has found our feature file and read it back to us.<span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 7</span> We can
see a summary of the test results below the scenario: <span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 8</span> one scenario, <span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 9</span> three
steps - all undefined. <span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 10</span></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span>bundle <span class="nb">exec </span>cucumber
Feature: Hear shout

  Scenario: Listener is within range         <span class="c"># features/hear_shout.feature:2</span>
    Given Lucy is located 15m from Sean      <span class="c"># features/hear_shout.feature:3</span>
    When Sean shouts <span class="s2">"free bagels at Sean's"</span> <span class="c"># features/hear_shout.feature:4</span>
    Then Lucy hears Sean<span class="s1">'s message           # features/hear_shout.feature:5

1 scenario (1 undefined)
3 steps (3 undefined)
0m0.051s

You can implement step definitions for undefined steps with these snippets:

Given("Lucy is located {int}m from Sean") do |int|
  pending # Write code here that turns the phrase above into concrete actions
end

When("Sean shouts {string}") do |string|
  pending # Write code here that turns the phrase above into concrete actions
end

Then("Lucy hears Sean'</span>s message<span class="s2">") do
  pending # Write code here that turns the phrase above into concrete actions
end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 11</span>
<em>Undefined</em> means Cucumber doesn’t know what to do for any of the three steps we wrote in our Gherkin scenario. It needs us to provide some <em>step definitions</em>.</p>
</div>
<div class="videoblock">
<div class="content">
<video src="02.04.animation.mp4" controls>
Your browser does not support the video tag.
</video>
</div>
</div>
<div class="paragraph">
<p>Step definitions translate from the plain language you use in Gherkin into Ruby code.</p>
</div>
<div class="paragraph">
<p>When Cucumber runs a step, it looks for a step definition that matches the text in the Gherkin step. If it finds one, then it executes the code in the step definition.</p>
</div>
<div class="paragraph">
<p>If it doesn’t find one… well, you’ve just seen what happens. Cucumber helpfully prints out some code snippets that we can use as a basis for new step definitions.</p>
</div>
<div class="paragraph">
<p><span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 12</span>
Let’s copy those to create our first step definitions.</p>
</div>
<div class="paragraph">
<p><span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 13</span> <span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 14</span>
We’ll paste them into a Ruby file under the <code>step_definitions</code> directory, inside the <code>features</code> directory. We&#8217;ll just call it <code>steps.rb</code>.</p>
</div>
<div class="listingblock">
<div class="title">steps.rb</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="no">Given</span><span class="p">(</span><span class="s2">"Lucy is located {int}m from Sean"</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">int</span><span class="o">|</span>
  <span class="n">pending</span> <span class="c1"># Write code here that turns the phrase above into concrete actions</span>
<span class="k">end</span>

<span class="no">When</span><span class="p">(</span><span class="s2">"Sean shouts {string}"</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">string</span><span class="o">|</span>
  <span class="n">pending</span> <span class="c1"># Write code here that turns the phrase above into concrete actions</span>
<span class="k">end</span>

<span class="no">Then</span><span class="p">(</span><span class="s2">"Lucy hears Sean's message"</span><span class="p">)</span> <span class="k">do</span>
  <span class="n">pending</span> <span class="c1"># Write code here that turns the phrase above into concrete actions</span>
<span class="k">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 15</span>
Now run Cucumber again.</p>
</div>
<div class="paragraph">
<p>This time the output is a little different. None of the steps are undefined anymore. We now have a pending step <span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 16</span> and two skipped ones.<span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 17</span> This means Cucumber found all our step definitions, and executed the first one.
<span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 18</span>
But that first step definition throws a <code>PendingException</code>, which causes Cucumber to stop, skip the rest of the steps, and mark the scenario as pending.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span>bundle <span class="nb">exec </span>cucumber
Feature: Hear shout

  Scenario: Listener is within range         <span class="c"># features/hear_shout.feature:2</span>
    Given Lucy is located 15m from Sean      <span class="c"># features/step_definitions/steps.rb:1</span>
      TODO <span class="o">(</span>Cucumber::Pending<span class="o">)</span>
      ./features/step_definitions/steps.rb:2:in <span class="sb">`</span><span class="s2">"Lucy is located {int}m from Sean"</span><span class="s1">'
      features/hear_shout.feature:3:in `Given Lucy is located 15m from Sean'</span>
    When Sean shouts <span class="s2">"free bagels at Sean's"</span> <span class="c"># features/step_definitions/steps.rb:5</span>
    Then Lucy hears Sean<span class="s1">'s message           # features/step_definitions/steps.rb:9

1 scenario (1 pending)
3 steps (2 skipped, 1 pending)
0m0.008s</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now that we&#8217;ve wired up our step definitions to the Gherkin steps, it&#8217;s almost time to start working on our solution. First though, let&#8217;s tidy up the generated code.</p>
</div>
<div class="paragraph">
<p><span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 19</span>
We&#8217;ll rename the <code>int</code> parameter to something that better reflects its meaning. We’ll call it <code>distance</code>.</p>
</div>
<div class="paragraph">
<p><span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 20</span>
We can print it to the terminal to see what&#8217;s happening.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="no">Given</span><span class="p">(</span><span class="s2">"Lucy is located {int}m from Sean"</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">distance</span><span class="o">|</span>
  <span class="nb">puts</span> <span class="n">distance</span>
  <span class="n">pending</span> <span class="c1"># Write code here that turns the phrase above into concrete actions</span>
<span class="k">end</span>

<span class="no">When</span><span class="p">(</span><span class="s2">"Sean shouts {string}"</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">string</span><span class="o">|</span>
  <span class="n">pending</span> <span class="c1"># Write code here that turns the phrase above into concrete actions</span>
<span class="k">end</span>

<span class="no">Then</span><span class="p">(</span><span class="s2">"Lucy hears Sean's message"</span><span class="p">)</span> <span class="k">do</span>
  <span class="n">pending</span> <span class="c1"># Write code here that turns the phrase above into concrete actions</span>
<span class="k">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If we run <code>cucumber</code> again on our terminal, <span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 21</span> we can see the number 15 pop up in the output.<span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 22</span></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span>bundle <span class="nb">exec </span>cucumber
Feature: Hear shout

  Scenario: Listener is within range         <span class="c"># features/hear_shout.feature:2</span>
    Given Lucy is located 15m from Sean      <span class="c"># features/step_definitions/steps.rb:1</span>
      15
      TODO <span class="o">(</span>Cucumber::Pending<span class="o">)</span>
      ./features/step_definitions/steps.rb:3:in <span class="sb">`</span><span class="s2">"Lucy is located {int}m from Sean"</span><span class="s1">'
      features/hear_shout.feature:3:in `Given Lucy is located 15m from Sean'</span>
    When Sean shouts <span class="s2">"free bagels at Sean's"</span> <span class="c"># features/step_definitions/steps.rb:6</span>
    Then Lucy hears Sean<span class="s1">'s message           # features/step_definitions/steps.rb:10

1 scenario (1 pending)
3 steps (2 skipped, 1 pending)
0m0.005s</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice that the number 15 does not appear anywhere in our Ruby code. The value is automatically passed from the Gherkin step to the step definition. If you&#8217;re curious, that’s the <span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 23</span><code>{int}</code> in the step definition pattern or <em>cucumber expression</em>. We’ll explain these patterns in detail in a future lesson.</p>
</div>
</div>
<div class="sect2">
<h3 id="_sketch_out_the_solution">2.5. Sketch out the solution</h3>
<div class="audioblock">
<div class="content">
<audio src="02.05.ruby.audio.mp3" controls>
Your browser does not support the audio tag.
</audio>
</div>
</div>
<div class="paragraph">
<p><span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 1</span>
Now that we have the step definitions matching, we can start working on our solution. We like to use our scenarios to <em>guide</em> our development, so we&#8217;ll start designing the objects we&#8217;ll need by sketching out some code in our step definitions.</p>
</div>
<div class="paragraph">
<p>The scenario will be failing while we do this, but we should see the error messages gradually progressing as we drive out the interface to our object model.</p>
</div>
<div class="paragraph">
<p>Our next goal is for the scenario to fail because we need to implement the actual business logic. <em>Then</em> we can work on changing the business logic inside our objects to make it pass.</p>
</div>
<div class="listingblock">
<div class="title">steps.rb</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="no">Given</span><span class="p">(</span><span class="s2">"Lucy is located {int}m from Sean"</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">distance</span><span class="o">|</span>
  <span class="nb">puts</span> <span class="n">distance</span>
  <span class="n">pending</span> <span class="c1"># Write code here that turns the phrase above into concrete actions</span>
<span class="k">end</span>

<span class="no">When</span><span class="p">(</span><span class="s2">"Sean shouts {string}"</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">string</span><span class="o">|</span>
  <span class="n">pending</span> <span class="c1"># Write code here that turns the phrase above into concrete actions</span>
<span class="k">end</span>

<span class="no">Then</span><span class="p">(</span><span class="s2">"Lucy hears Sean's message"</span><span class="p">)</span> <span class="k">do</span>
  <span class="n">pending</span> <span class="c1"># Write code here that turns the phrase above into concrete actions</span>
<span class="k">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 2</span>
To implement the first step, we need to create a couple of <code>Person</code> objects, with the specified distance between them. <span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 3</span> We can remove the <code>pending</code> status now, and this <code>puts</code> statement,<span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 4</span> and write the implementation for the first step like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="no">Given</span><span class="p">(</span><span class="s2">"Lucy is located {int}m from Sean"</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">distance</span><span class="o">|</span>
  <span class="vi">@lucy</span> <span class="o">=</span> <span class="no">Shouty</span><span class="o">::</span><span class="no">Person</span><span class="p">.</span><span class="nf">new</span>
  <span class="vi">@sean</span> <span class="o">=</span> <span class="no">Shouty</span><span class="o">::</span><span class="no">Person</span><span class="p">.</span><span class="nf">new</span>
  <span class="vi">@lucy</span><span class="p">.</span><span class="nf">move_to</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span>
<span class="k">end</span>

<span class="no">When</span><span class="p">(</span><span class="s2">"Sean shouts “free bagels at Sean’s”"</span><span class="p">)</span> <span class="k">do</span>
  <span class="n">pending</span> <span class="c1"># Write code here that turns the phrase above into concrete actions</span>
<span class="k">end</span>

<span class="no">Then</span><span class="p">(</span><span class="s2">"Lucy hears Sean’s message"</span><span class="p">)</span> <span class="k">do</span>
  <span class="n">pending</span> <span class="c1"># Write code here that turns the phrase above into concrete actions</span>
<span class="k">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>We have two instances of person, one representing Lucy, <span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 5</span>and one representing Sean. <span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 6</span>Then we call a method to move Lucy to the position specified in the scenario.<span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 7</span></p>
</div>
<div class="videoblock">
<div class="content">
<video src="02.05.animation.mp4" controls>
Your browser does not support the video tag.
</video>
</div>
</div>
<div class="paragraph">
<p>To keep things simple, we&#8217;re going to assume all people are situated on a line: a one-dimensional co-ordinate system. We can always introduce proper geo-locations later. We&#8217;ll place Sean in the centre, and Lucy 15 metres away from Sean.</p>
</div>
<div class="paragraph">
<p>This might not be the design we&#8217;ll end up with once this is all working, but it&#8217;s a decent place to start.</p>
</div>
<div class="paragraph">
<p><span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 8</span>
If we run Cucumber, we’ll see a compilation error from Ruby. we need to define our <code>Shouty</code> module.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span>bundle <span class="nb">exec </span>cucumber
Feature: Hear shout

  Scenario: Listener is within range         <span class="c"># features/hear_shout.feature:2</span>
    Given Lucy is located 15m from Sean      <span class="c"># features/step_definitions/steps.rb:1</span>
      uninitialized constant Shouty <span class="o">(</span>NameError<span class="o">)</span>
      ./features/step_definitions/steps.rb:2:in <span class="sb">`</span><span class="s2">"Lucy is located {int}m from Sean"</span><span class="s1">'
      features/hear_shout.feature:3:in `Given Lucy is located 15m from Sean'</span>
    When Sean shouts <span class="s2">"free bagels at Sean's"</span> <span class="c"># features/step_definitions/steps.rb:7</span>
    Then Lucy hears Sean<span class="s1">'s message           # features/step_definitions/steps.rb:11

Failing Scenarios:
cucumber features/hear_shout.feature:2 # Scenario: Listener is within range

1 scenario (1 failed)
3 steps (1 failed, 2 skipped)
0m0.004s</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 9</span>
Let’s give our solution a home by creating a <code>lib</code> directory.
<span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 10</span>
We’ll put our Shouty application in a Ruby file called <code>shouty.rb</code> in that directory.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span><span class="nb">mkdir </span>lib
<span class="nv">$ </span><span class="nb">touch </span>lib/shouty.rb</code></pre>
</div>
</div>
<div class="paragraph">
<p><span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 11</span>
Create a <code>Shouty</code> module, then an empty <code>Person</code> class inside it. <span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 12</span></p>
</div>
<div class="listingblock">
<div class="title">lib/shouty.rb</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="k">module</span> <span class="nn">Shouty</span>
  <span class="k">class</span> <span class="nc">Person</span>

  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 13</span>
For now, we’ll just require the shouty application from our <code>steps.rb</code> file. In a later lesson we’ll talk more about how to organise this code a bit better.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="nb">require</span> <span class="s1">'shouty'</span>

<span class="no">Given</span><span class="p">(</span><span class="s2">"Lucy is located {int}m from Sean"</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">distance</span><span class="o">|</span>
 <span class="c1"># ...</span>
<span class="k">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 14</span>
When we run the scenario this time, Cucumber tells us that we&#8217;re missing the <code>move_to</code> method on the <code>Person</code> class. <span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 15</span></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>$ bundle exec cucumber
Feature: Hear shout

  Scenario: Listener is within range         # features/hear_shout.feature:2
    Given Lucy is located 15m from Sean      # features/step_definitions/steps.rb:3
      undefined method `move_to' for #&lt;Shouty::Person:0x00007fed0da12b68&gt; (NoMethodError)
      ./features/step_definitions/steps.rb:6:in `"Lucy is located {int}m from Sean"'
      features/hear_shout.feature:3:in `Given Lucy is located 15m from Sean'
    When Sean shouts "free bagels at Sean's" # features/step_definitions/steps.rb:9
    Then Lucy hears Sean's message           # features/step_definitions/steps.rb:13

Failing Scenarios:
cucumber features/hear_shout.feature:2 # Scenario: Listener is within range

1 scenario (1 failed)
3 steps (1 failed, 2 skipped)
0m0.004s</code></pre>
</div>
</div>
<div class="paragraph">
<p><span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 16</span>
We&#8217;ll add the method definition without implementing it yet.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="k">module</span> <span class="nn">Shouty</span>
  <span class="k">class</span> <span class="nc">Person</span>
    <span class="k">def</span> <span class="nf">move_to</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span>

    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 17</span>
When we run the scenario again, the first step is green!</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">bundle <span class="nb">exec </span>cucumber
Feature: Hear shout

  Scenario: Listener is within range         <span class="c"># features/hear_shout.feature:2</span>
    Given Lucy is located 15m from Sean      <span class="c"># features/step_definitions/steps.rb:3</span>
    When Sean shouts <span class="s2">"free bagels at Sean's"</span> <span class="c"># features/step_definitions/steps.rb:9</span>
      TODO <span class="o">(</span>Cucumber::Pending<span class="o">)</span>
      ./features/step_definitions/steps.rb:10:in <span class="sb">`</span><span class="s2">"Sean shouts {string}"</span><span class="s1">'
      features/hear_shout.feature:4:in `When Sean shouts "free bagels at Sean'</span>s<span class="s2">"'
    Then Lucy hears Sean's message           # features/step_definitions/steps.rb:13

1 scenario (1 pending)
3 steps (1 skipped, 1 pending, 1 passed)
0m0.006s</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>We&#8217;re making progress!</p>
</div>
<div class="paragraph">
<p>We&#8217;ll keep working like this until we see the scenario failing for the right reasons.</p>
</div>
<div class="paragraph">
<p>In the second step definition, we want to tell Sean to shout something.</p>
</div>
<div class="paragraph">
<p><span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 18</span>
In order to send instructions to Sean from the second step, we&#8217;ve stored him in an <em>instance variable</em>, so that he’ll be accessible from all of our step definitions.</p>
</div>
<div class="paragraph">
<p><span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 19</span>
In the <code>When</code> step, we&#8217;re capturing Sean&#8217;s message using the <code>{string}</code> pattern, so let&#8217;s give that argument a more meaningful name.<span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 20</span></p>
</div>
<div class="paragraph">
<p><span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 21</span>
And now we can now tell him to <em>shout</em> the message:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="no">When</span><span class="p">(</span><span class="s2">"Sean shouts {string}"</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">message</span><span class="o">|</span>
  <span class="vi">@sean</span><span class="p">.</span><span class="nf">shout</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
<span class="k">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 22</span>
If we run Cucumber, it&#8217;s telling is that our <code>Person</code> class needs a <code>shout</code> method.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">bundle <span class="nb">exec </span>cucumber
Feature: Hear shout

  Scenario: Listener is within range         <span class="c"># features/hear_shout.feature:2</span>
    Given Lucy is located 15m from Sean      <span class="c"># features/step_definitions/steps.rb:4</span>
    When Sean shouts <span class="s2">"free bagels at Sean's"</span> <span class="c"># features/step_definitions/steps.rb:10</span>
      undefined method <span class="sb">`</span>shout<span class="s1">' for #&lt;Shouty::Person:0x0000558e1ee78428&gt; (NoMethodError)
      ./features/step_definitions/steps.rb:11:in `"Sean shouts {string}"'</span>
      features/hear_shout.feature:4:in <span class="sb">`</span>When Sean shouts <span class="s2">"free bagels at Sean's"</span><span class="s1">'
    Then Lucy hears Sean’s message           # features/step_definitions/steps.rb:14

Failing Scenarios:
cucumber features/hear_shout.feature:2 # Scenario: Listener is within range

1 scenario (1 failed)
3 steps (1 failed, 1 skipped, 1 passed)
0m0.003s</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 23</span>
Let’s not worry about the implementation yet. The most important thing right now is to discover the shape of our domain model.</p>
</div>
<div class="listingblock">
<div class="title">shouty.rb</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="k">module</span> <span class="nn">Shouty</span>
  <span class="k">class</span> <span class="nc">Person</span>
    <span class="k">def</span> <span class="nf">move_to</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span>

    <span class="k">end</span>

    <span class="k">def</span> <span class="nf">shout</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 24</span>
The last step definition is where we implement a check, or assertion. We&#8217;ll verify that what Lucy has heard is exactly the same as what Sean shouted.</p>
</div>
<div class="paragraph">
<p><span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 25</span>
Once again we&#8217;re going to write the code we wish we had.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="no">Then</span><span class="p">(</span><span class="s2">"Lucy hears Sean's message"</span><span class="p">)</span> <span class="k">do</span>
  <span class="n">expect</span><span class="p">(</span><span class="vi">@lucy</span><span class="p">.</span><span class="nf">messages_heard</span><span class="p">).</span><span class="nf">to</span> <span class="kp">include</span> <span class="vi">@message_from_sean</span>
<span class="k">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>So we need a way to ask Lucy what messages she&#8217;s heard, and we also need to know what it was that Sean shouted.</p>
</div>
<div class="paragraph">
<p>We can record what Sean shouts by storing it in an instance variable as the <code>When</code> step runs.<span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 26</span> This is a common pattern to use in Cucumber step definitions when you don’t want to repeat the same test data in different parts of a scenario. Now we can use that in the assertion check.<span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 27</span></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="no">When</span><span class="p">(</span><span class="s2">"Sean shouts {string}"</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">message</span><span class="o">|</span>
  <span class="vi">@sean</span><span class="p">.</span><span class="nf">shout</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
  <span class="vi">@message_from_sean</span> <span class="o">=</span> <span class="n">message</span>
<span class="k">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>We also need to add a <code>messages_heard</code> method to our Person class.<span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 28</span> Let&#8217;s do that now, we&#8217;ll just return an empty array for now.<span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 29</span></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="k">module</span> <span class="nn">Shouty</span>
  <span class="k">class</span> <span class="nc">Person</span>
    <span class="k">def</span> <span class="nf">move_to</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span>

    <span class="k">end</span>

    <span class="k">def</span> <span class="nf">shout</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

    <span class="k">end</span>

    <span class="k">def</span> <span class="nf">messages_heard</span>
      <span class="p">[]</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>&#8230;&#8203;and watch Cucumber run the tests again.<span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 30</span></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span>bundle <span class="nb">exec </span>cucumber
Feature: Hear shout

  Scenario: Listener is within range         <span class="c"># features/hear_shout.feature:2</span>
    Given Lucy is located 15m from Sean      <span class="c"># features/step_definitions/steps.rb:4</span>
    When Sean shouts <span class="s2">"free bagels at Sean's"</span> <span class="c"># features/step_definitions/steps.rb:10</span>
    Then Lucy hears Sean’s message           <span class="c"># features/step_definitions/steps.rb:15</span>
      expected <span class="o">[]</span> to include <span class="s2">"free bagels at Sean's"</span> <span class="o">(</span>RSpec::Expectations::ExpectationNotMetError<span class="o">)</span>
      ./features/step_definitions/steps.rb:16:in <span class="sb">`</span><span class="s2">"Lucy hears Sean’s message"</span><span class="s1">'
      features/hear_shout.feature:5:in `Then Lucy hears Sean’s message'</span>

Failing Scenarios:
cucumber features/hear_shout.feature:2 <span class="c"># Scenario: Listener is within range</span>

1 scenario <span class="o">(</span>1 failed<span class="o">)</span>
3 steps <span class="o">(</span>1 failed, 2 passed<span class="o">)</span>
0m0.032s</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is great! Whenever we do BDD, getting to our first failing test is a milestone. Seeing the test fail proves that it is capable of detecting errors in our code!</p>
</div>
<div class="paragraph">
<p>Never trust an automated test that you haven’t seen fail!</p>
</div>
<div class="paragraph">
<p>Now all we have to do is write the code to make it do what it&#8217;s supposed to.</p>
</div>
</div>
<div class="sect2">
<h3 id="_make_the_scenario_pass">2.6. Make the scenario pass</h3>
<div class="audioblock">
<div class="content">
<audio src="02.06.audio.mp3" controls>
Your browser does not support the audio tag.
</audio>
</div>
</div>
<div class="paragraph">
<p>So we have our failing scenario: <span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 1</span></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">bundle <span class="nb">exec </span>cucumber
Feature: Hear shout

  Scenario: Listener is within range         <span class="c"># features/hear_shout.feature:2</span>
    Given Lucy is located 15m from Sean      <span class="c"># features/step_definitions/steps.rb:4</span>
    When Sean shouts <span class="s2">"free bagels at Sean's"</span> <span class="c"># features/step_definitions/steps.rb:10</span>
    Then Lucy hears Sean’s message           <span class="c"># features/step_definitions/steps.rb:15</span>
      expected <span class="o">[]</span> to include <span class="s2">"free bagels at Sean's"</span> <span class="o">(</span>RSpec::Expectations::ExpectationNotMetError<span class="o">)</span>
      ./features/step_definitions/steps.rb:16:in <span class="sb">`</span><span class="s2">"Lucy hears Sean’s message"</span><span class="s1">'
      features/hear_shout.feature:5:in `Then Lucy hears Sean’s message'</span>

Failing Scenarios:
cucumber features/hear_shout.feature:2 <span class="c"># Scenario: Listener is within range</span>

1 scenario <span class="o">(</span>1 failed<span class="o">)</span>
3 steps <span class="o">(</span>1 failed, 2 passed<span class="o">)</span>
0m0.032s</code></pre>
</div>
</div>
<div class="paragraph">
<p>Lucy is expected to hear Sean&#8217;s message, but she hasn&#8217;t heard anything: we got an empty Array back from the <code>messages_heard</code> method.<span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 2</span></p>
</div>
<div class="paragraph">
<p><span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 3</span>
In this case, we’re going to cheat. We have a one-line fix that will make this scenario pass, but it’s not a particularly future-proof implementation. Can you guess what it is?<span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 4</span></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="k">module</span> <span class="nn">Shouty</span>
  <span class="k">class</span> <span class="nc">Person</span>
    <span class="k">def</span> <span class="nf">move_to</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span>

    <span class="k">end</span>

    <span class="k">def</span> <span class="nf">shout</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

    <span class="k">end</span>

    <span class="k">def</span> <span class="nf">messages_heard</span>
      <span class="p">[</span><span class="s2">"free bagels at Sean's"</span><span class="p">]</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>I told you it wasn’t very future proof!</p>
</div>
<div class="paragraph">
<p><span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 5</span></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span>bundle e xec cucumber
Feature: Hear shout

  Scenario: Listener is within range         <span class="c"># features/hear_shout.feature:2</span>
    Given Lucy is located 15m from Sean      <span class="c"># features/step_definitions/steps.rb:4</span>
    When Sean shouts <span class="s2">"free bagels at Sean's"</span> <span class="c"># features/step_definitions/steps.rb:10</span>
    Then Lucy hears Sean’s message           <span class="c"># features/step_definitions/steps.rb:15</span>

1 scenario <span class="o">(</span>1 passed<span class="o">)</span>
3 steps <span class="o">(</span>3 passed<span class="o">)</span>
0m0.028s</code></pre>
</div>
</div>
<div class="paragraph">
<p>Woohoo! Our scenario is passing for the first time. As long as this is the only message anyone ever shouts, we&#8217;re good to ship this thing!</p>
</div>
<div class="paragraph">
<p>Now, the fact that such a poor implementation can pass our tests shows us that we need to work on our tests. A more comprehensive set of scenarios would guide us towards a better implementation.</p>
</div>
<div class="paragraph">
<p>It&#8217;s also a good habit to look for the most simple solution. We can trust that, as our scenarios evolve, so will our solution.</p>
</div>
<div class="paragraph">
<p>This is the essence of Behaviour-Driven Development. Examples of behaviour drive the development. We do just enough to make the next scenario pass, and no more.</p>
</div>
<div class="paragraph">
<p>Instead of writing a note on our TODO list, let&#8217;s write another scenario that shouts a different message. <span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 6</span></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin"><span class="kd">Feature</span><span class="p">:</span> Hear shout
  <span class="kn">Scenario</span><span class="p">:</span> Listener is within range
    <span class="nf">Given </span>Lucy is located 15m from Sean
    <span class="nf">When </span>Sean shouts <span class="s">"free bagels at Sean's"</span>
    <span class="nf">Then </span>Lucy hears Sean’s message

  <span class="kn">Scenario</span><span class="p">:</span> Listener hears a different message
    <span class="nf">Given </span>Lucy is located 15m from Sean
    <span class="nf">When </span>Sean shouts <span class="s">"Free coffee!"</span>
    <span class="nf">Then </span>Lucy hears Sean's message</code></pre>
</div>
</div>
<div class="paragraph">
<p>It fails, reminding us we need to find a solution that doesn&#8217;t rely on hard-coding the message. <span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot 7</span>
Now when we come back to this code, we can just run the tests and Cucumber will remind us what we need to do next. We&#8217;re done for today!</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span>bundle <span class="nb">exec </span>cucumber
Feature: Hear shout

  Scenario: Listener is within range         <span class="c"># features/hear_shout.feature:2</span>
    Given Lucy is located 15m from Sean      <span class="c"># features/step_definitions/steps.rb:3</span>
    When Sean shouts <span class="s2">"free bagels at Sean's"</span> <span class="c"># features/step_definitions/steps.rb:9</span>
    Then Lucy hears Sean<span class="s1">'s message           # features/step_definitions/steps.rb:14

  Scenario: Listener hears a different message # features/hear_shout.feature:7
    Given Lucy is located 15m from Sean        # features/step_definitions/steps.rb:3
    When Sean shouts "Free coffee!"            # features/step_definitions/steps.rb:9
    Then Lucy hears Sean'</span>s message             <span class="c"># features/step_definitions/steps.rb:14</span>
      expected <span class="o">[</span><span class="s2">"free bagels at Sean's"</span><span class="o">]</span> to include <span class="s2">"Free coffee!"</span> <span class="o">(</span>RSpec::Expectations::ExpectationNotMetError<span class="o">)</span>
      ./features/step_definitions/steps.rb:15:in <span class="sb">`</span><span class="s2">"Lucy hears Sean's message"</span><span class="s1">'
      features/hear_shout.feature:10:in `Then Lucy hears Sean'</span>s message<span class="s1">'

Failing Scenarios:
cucumber features/hear_shout.feature:7 # Scenario: Listener hears a different message

2 scenarios (1 failed, 1 passed)
6 steps (1 failed, 5 passed)
0m0.039s</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Of course, if you&#8217;re in the mood, you can always try to implement a solution yourself that makes both scenarios pass. Have fun!</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_expressing_yourself">3. Expressing yourself</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_cucumber_expressions_not_regular_expressions">3.1. Cucumber expressions not regular expressions</h3>
<div class="videoblock">
<div class="content">
<video src="03.01.animation.mp4" controls>
Your browser does not support the video tag.
</video>
</div>
</div>
<div class="paragraph">
<p>In the previous chapter we explored the fundamental components of a Cucumber test suite, and how we use Cucumber to drive out a solution, test-first.</p>
</div>
<div class="paragraph">
<p>First we specified the behaviour we wanted, using a Gherkin scenario in a feature file. Then we wrote step definitions to translate the plain english from our scenario into concrete actions in code. Finally, we used the step definitions to guide us in building out our very basic domain model for the Shouty application.</p>
</div>
<div class="paragraph">
<p>We tend to think of the code that actually pokes around with the system as distinct from the step definitions, so we’ve drawn an extra box labelled "automation code" for this.</p>
</div>
<div class="paragraph">
<p>Automation code can do almost anything to your application: it can drive a web browser around your site, make HTTP requests to a REST API, or&#8201;&#8212;&#8201;as you’ve already seen&#8201;&#8212;&#8201;drive a domain model directly.</p>
</div>
<div class="paragraph">
<p>Automation code is a big topic that we’ll come back to. First, we want to concentrate on step definitions.
Good step definitions are important because they enable the <em>readability</em> of your scenarios. The better you are at matching plain language phrases from Gherkin, the more expressive you can be when writing scenarios. Teams who do this well refer to their features as <em>living documentation</em> - a specification document that never goes out of date.</p>
</div>
<div class="paragraph">
<p>When Cucumber first started, we used to use <em>regular expressions</em> to match plain language phrases from Gherkin steps.</p>
</div>
<div class="paragraph">
<p>Regular expressions have quite an intimidating reputation.</p>
</div>
<div class="paragraph">
<p>So we replaced them with something simpler, something we call <em>Cucumber expressions</em>. Cucumber is backwards compatible so you can still use the power of regular expressions if that&#8217;s your thing.</p>
</div>
<div class="paragraph">
<p>This chapter is all about Cucumber Expressions.</p>
</div>
</div>
<div class="sect2">
<h3 id="_literal_expressions">3.2. Literal expressions</h3>
<div class="paragraph">
<p>Let&#8217;s look at the Shouty scenario from the last chapter.</p>
</div>
<div class="listingblock">
<div class="title">hear_shout.feature</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin"><span class="kd">Feature</span><span class="p">:</span> Hear shout
  <span class="kn">Scenario</span><span class="p">:</span> Listener is within range
    <span class="nf">Given </span>Lucy is located 15 metres from Sean
    <span class="nf">When </span>Sean shouts <span class="s">"free bagels at Sean's"</span>
    <span class="nf">Then </span>Lucy hears Sean's message</code></pre>
</div>
</div>
<div class="paragraph">
<p>As Cucumber starts to execute this feature, it will come to the first step of the scenario <code>Given Lucy is 15 metres from Sean</code> and say to itself "now - do I have any step definitions that match the phrase <code>Lucy is 15 metres from Sean</code>?”"</p>
</div>
<div class="paragraph">
<p>The most simple cucumber expression that would match that step is this one:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Lucy is located 15 metres from Sean</pre>
</div>
</div>
<div class="paragraph">
<p>That’s pretty simple isn&#8217;t it? Cucumber expressions are just string patterns, and the most simple pattern you can use is a perfect match.</p>
</div>
<div class="paragraph">
<p>In Ruby, we can use this pattern to make a step definition like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="no">Given</span><span class="p">(</span><span class="s2">"Lucy is located 15 metres from Sean"</span><span class="p">)</span> <span class="k">do</span>
  <span class="c1"># TODO: automation code to place Lucy and Sean goes here</span>
  <span class="n">pending</span> <span class="s2">"matched!"</span>
<span class="k">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>We use a normal Ruby string to pass the cucumber expression to Cucumber.</p>
</div>
</div>
<div class="sect2">
<h3 id="_capturing_parameters">3.3. Capturing parameters</h3>
<div class="paragraph">
<p>Sometimes, we want to write step defintions that allow us to use different values in our Gherkin scenarios. For example, we might want to have other scenarios that place Lucy a different distance away from Sean.</p>
</div>
<div class="listingblock">
<div class="title">hear_shout.feature</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin"><span class="kd">Feature</span><span class="p">:</span> Hear shout
  <span class="kn">Scenario</span><span class="p">:</span> Listener is within range
    <span class="nf">Given </span>Lucy is located 100 metres from Sean
    <span class="nf">When </span>Sean shouts <span class="s">"free bagels at Sean's"</span>
    <span class="nf">Then </span>Lucy hears Sean's message</code></pre>
</div>
</div>
<div class="paragraph">
<p>To capture interesting values from our step definitions, we can use a feature of Cucumber Expressions called <em>parameters</em>.</p>
</div>
<div class="paragraph">
<p>For example, to capture the number of metres, we can use the <code>{int}</code> parameter: <span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot </span> which is passed as an argument to our step definition block: <span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot </span></p>
</div>
<div class="listingblock">
<div class="title">steps.rb</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="no">Given</span><span class="p">(</span><span class="s2">"Lucy is located {int} metres from Sean"</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">distance</span><span class="o">|</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now we’re capturing that value as an argument. The value <code>100</code> will be passed to our code automatically by Cucumber.</p>
</div>
<div class="paragraph">
<p>Because we&#8217;ve used Cucumber Expressions' built-in <code>{int}</code> parameter type, the value has been cast to an <code>Integer</code> data type for us automatically, so we can do maths with it if we want.<span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot </span></p>
</div>
<div class="listingblock">
<div class="title">steps.rb</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="no">Given</span><span class="p">(</span><span class="s2">"Lucy is located {int} metres from Sean"</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">distance</span><span class="o">|</span>
  <span class="c1"># TODO: automation code to place Lucy and Sean goes here</span>
  <span class="n">pending</span> <span class="s2">"Lucy is </span><span class="si">#{</span><span class="n">distance</span> <span class="o">*</span> <span class="mi">100</span><span class="si">}</span><span class="s2"> centimetres from Sean"</span>
<span class="k">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Cucumber has a bunch of built-in parameter types: <code>{int}</code>, <code>{float}</code>, <code>{word}</code> and <code>{string}</code>. You can also define your own, as we&#8217;ll see later.</p>
</div>
</div>
<div class="sect2">
<h3 id="_flexibility">3.4. Flexibility</h3>
<div class="paragraph">
<p>Although it&#8217;s important to try to use consistent terminology in our Gherkin scenarios to help develop the ubiquitous language of your domain, we also want scenarios to read naturally, which sometimes means allowing a bit of flexibility.</p>
</div>
<div class="paragraph">
<p>Ideally, the language used in scenarios should never be constrained by your step definitions. Otherwise they&#8217;ll end up sounding like they were written by robots. Or worse, they read like code.</p>
</div>
<div class="paragraph">
<p>One common example is the problem of plurals. Suppose we want to place Lucy and Sean just 1 metre apart:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin">    <span class="nf">Given </span>Lucy is located 1 metre from Sean</code></pre>
</div>
</div>
<div class="paragraph">
<p>Because we’ve used the singular <code>metre</code> instead of the plural <code>metres</code> we don&#8217;t get a match:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>$ bundle exec cucumber
Feature: Hear shout

  Scenario: Listener is within range         # features/hear_shout.feature:2
    Given Lucy is located 1 metre from Sean  # features/hear_shout.feature:3
    When Sean shouts "free bagels at Sean's" # features/step_definitions/steps.rb:8
    Then Lucy hears Sean's message           # features/step_definitions/steps.rb:13

1 scenario (1 undefined)
3 steps (2 skipped, 1 undefined)
0m0.017s

You can implement step definitions for undefined steps with these snippets:

Given("Lucy is located {int} metre from Sean") do |int|
  pending # Write code here that turns the phrase above into concrete actions
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>What a pain!</p>
</div>
<div class="paragraph">
<p>Fear not. We can just surround the <code>s</code> in parentheses to make it optional, like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="no">Given</span><span class="p">(</span><span class="s2">"Lucy is located {int} metre(s) from Sean"</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">distance</span><span class="o">|</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now our step matches:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>$ bundle exec cucumber
Feature: Hear shout

  Scenario: Listener is within range         # features/hear_shout.feature:2
    Given Lucy is located 1 metre from Sean  # features/step_definitions/steps.rb:3
      Lucy is 100 centimetres from Sean (Cucumber::Pending)
      ./features/step_definitions/steps.rb:5:in `"Lucy is located {int} metre(s) from Sean"'
      features/hear_shout.feature:3:in `Given Lucy is located 1 metre from Sean'
    When Sean shouts "free bagels at Sean's" # features/step_definitions/steps.rb:8
    Then Lucy hears Sean's message           # features/step_definitions/steps.rb:13

1 scenario (1 pending)
3 steps (2 skipped, 1 pending)</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is one way to smooth off some of the rough edges in your cucumber expressions, and allow your scenarios to be as expressive as possible.</p>
</div>
<div class="paragraph">
<p>Another is to allow <em>alternates</em> - different ways of saying the same thing. For example, to accept this step:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin">    <span class="nf">Given </span>Lucy is standing 1 metre from Sean</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#8230;&#8203;we can use this Cucumber Expression:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="no">Given</span><span class="p">(</span><span class="s2">"Lucy is located/standing {int} metre(s) from Sean"</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">distance</span><span class="o">|</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now we can use either 'standing' or 'located' in our scenarios, and both will match just fine:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>$ bundle exec cucumber
Feature: Hear shout

  Scenario: Listener is within range         # features/hear_shout.feature:2
    Given Lucy is standing 1 metre from Sean # features/step_definitions/steps.rb:3
      Lucy is 100 centimetres from Sean (Cucumber::Pending)
      ./features/step_definitions/steps.rb:5:in `"Lucy is located/standing {int} metre(s) from Sean"'
      features/hear_shout.feature:3:in `Given Lucy is standing 1 metre from Sean'
    When Sean shouts "free bagels at Sean's" # features/step_definitions/steps.rb:8
    Then Lucy hears Sean's message           # features/step_definitions/steps.rb:13

1 scenario (1 pending)
3 steps (2 skipped, 1 pending)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_custom_parameters">3.5. Custom parameters</h3>
<div class="paragraph">
<p>Although you can get a long way with Cucumber Expressions' built-in parameter types, you get real power when you define your own <em>custom parameter types</em>. This allows you to transform the text captured from the Gherkin into any object you like before it&#8217;s passed into your step definition.</p>
</div>
<div class="paragraph">
<p>For example, let&#8217;s define our own <code>{person}</code> custom parameter type that will convert the string <code>Lucy</code> into an instance of <code>Person</code> automatically.</p>
</div>
<div class="paragraph">
<p>We can start with the step definition, which would look something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="no">Given</span><span class="p">(</span><span class="s2">"{person} is located/standing {int} metre(s) from Sean"</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">person</span><span class="p">,</span> <span class="n">distance</span><span class="o">|</span>
  <span class="n">person</span><span class="p">.</span><span class="nf">move_to</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span>
<span class="k">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If we run Cucumber at this point we&#8217;ll see an error, because we haven&#8217;t defined the <code>{person}</code> parameter type yet.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ bundle exec cucumber
Undefined parameter type {person} (Cucumber::CucumberExpressions::UndefinedParameterTypeError)</pre>
</div>
</div>
<div class="paragraph">
<p>Here&#8217;s how we define one.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s create a new Ruby file in <code>features/support</code> called <code>person_parameter.rb</code>:</p>
</div>
<div class="listingblock">
<div class="title">person_parameter.rb</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="nb">require</span> <span class="s1">'shouty'</span>

<span class="no">ParameterType</span><span class="p">(</span>
  <span class="ss">name:        </span><span class="s1">'person'</span><span class="p">,</span>
  <span class="ss">regexp:      </span><span class="sr">/Lucy|Sean/</span><span class="p">,</span>
  <span class="ss">transformer: </span><span class="o">-&gt;</span> <span class="p">(</span><span class="nb">name</span><span class="p">)</span> <span class="p">{</span> <span class="no">Shouty</span><span class="o">::</span><span class="no">Person</span><span class="p">.</span><span class="nf">new</span> <span class="p">}</span>
<span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>We use the <code>ParameterType</code> DSL method from Cucumber to define our new parameter type. <span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot </span></p>
</div>
<div class="paragraph">
<p>We need to give it a <code>name</code> which is the name we&#8217;ll use inside the curly brackets in our step definition expressions. <span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot </span></p>
</div>
<div class="paragraph">
<p>We also need to define&#8201;&#8212;&#8201;gasp!&#8201;&#8212;&#8201;a regular expression. <span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot </span> This is neccesary to tell cucumber expressions what text to match when searching for this parameter in a Gherkin step. We won&#8217;t go into the details of regular expressions in this video, but in this case we&#8217;re just matching on either of the names of the people we&#8217;re using in our scenario.</p>
</div>
<div class="paragraph">
<p>Finally, there&#8217;s a transformer block, <span style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif;">Shot </span> which takes the text captured from the Gherkin step that matched the regular expression pattern, then runs some code. The return value of this block is what will be passed to the step definition. In this case, we&#8217;re passed the name of the person, though we don&#8217;t use it at the moment when constructing a <code>Person</code>.</p>
</div>
<div class="paragraph">
<p>All of this means that when we run our step, we&#8217;ll be passed an instance of <code>Person</code> into our step definition automatically.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>$ bundle exec cucumber
Feature: Hear shout

  Scenario: Listener is within range         # features/hear_shout.feature:2
    Given Lucy is standing 1 metre from Sean # features/step_definitions/steps.rb:3
    When Sean shouts "free bagels at Sean's" # features/step_definitions/steps.rb:8
    Then Lucy hears Sean's message           # features/step_definitions/steps.rb:14

1 scenario (1 passed)
3 steps (3 passed)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Custom parameters allow you to bring your domain <em>model</em> - the classes and methods in your solution - and your domain <em>language</em> - the words you use in your scenarios and step defintions - closer together.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2020-02-25 22:49:10 UTC
</div>
</div>
<style>
pre.rouge table td { padding: 5px; }
pre.rouge table pre { margin: 0; }
pre.rouge .cm {
  color: #999988;
  font-style: italic;
}
pre.rouge .cp {
  color: #999999;
  font-weight: bold;
}
pre.rouge .c1 {
  color: #999988;
  font-style: italic;
}
pre.rouge .cs {
  color: #999999;
  font-weight: bold;
  font-style: italic;
}
pre.rouge .c, pre.rouge .ch, pre.rouge .cd, pre.rouge .cpf {
  color: #999988;
  font-style: italic;
}
pre.rouge .err {
  color: #a61717;
  background-color: #e3d2d2;
}
pre.rouge .gd {
  color: #000000;
  background-color: #ffdddd;
}
pre.rouge .ge {
  color: #000000;
  font-style: italic;
}
pre.rouge .gr {
  color: #aa0000;
}
pre.rouge .gh {
  color: #999999;
}
pre.rouge .gi {
  color: #000000;
  background-color: #ddffdd;
}
pre.rouge .go {
  color: #888888;
}
pre.rouge .gp {
  color: #555555;
}
pre.rouge .gs {
  font-weight: bold;
}
pre.rouge .gu {
  color: #aaaaaa;
}
pre.rouge .gt {
  color: #aa0000;
}
pre.rouge .kc {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kd {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kn {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kp {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kr {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kt {
  color: #445588;
  font-weight: bold;
}
pre.rouge .k, pre.rouge .kv {
  color: #000000;
  font-weight: bold;
}
pre.rouge .mf {
  color: #009999;
}
pre.rouge .mh {
  color: #009999;
}
pre.rouge .il {
  color: #009999;
}
pre.rouge .mi {
  color: #009999;
}
pre.rouge .mo {
  color: #009999;
}
pre.rouge .m, pre.rouge .mb, pre.rouge .mx {
  color: #009999;
}
pre.rouge .sb {
  color: #d14;
}
pre.rouge .sc {
  color: #d14;
}
pre.rouge .sd {
  color: #d14;
}
pre.rouge .s2 {
  color: #d14;
}
pre.rouge .se {
  color: #d14;
}
pre.rouge .sh {
  color: #d14;
}
pre.rouge .si {
  color: #d14;
}
pre.rouge .sx {
  color: #d14;
}
pre.rouge .sr {
  color: #009926;
}
pre.rouge .s1 {
  color: #d14;
}
pre.rouge .ss {
  color: #990073;
}
pre.rouge .s, pre.rouge .sa, pre.rouge .dl {
  color: #d14;
}
pre.rouge .na {
  color: #008080;
}
pre.rouge .bp {
  color: #999999;
}
pre.rouge .nb {
  color: #0086B3;
}
pre.rouge .nc {
  color: #445588;
  font-weight: bold;
}
pre.rouge .no {
  color: #008080;
}
pre.rouge .nd {
  color: #3c5d5d;
  font-weight: bold;
}
pre.rouge .ni {
  color: #800080;
}
pre.rouge .ne {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nf, pre.rouge .fm {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nl {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nn {
  color: #555555;
}
pre.rouge .nt {
  color: #000080;
}
pre.rouge .vc {
  color: #008080;
}
pre.rouge .vg {
  color: #008080;
}
pre.rouge .vi {
  color: #008080;
}
pre.rouge .nv, pre.rouge .vm {
  color: #008080;
}
pre.rouge .ow {
  color: #000000;
  font-weight: bold;
}
pre.rouge .o {
  color: #000000;
  font-weight: bold;
}
pre.rouge .w {
  color: #bbbbbb;
}
pre.rouge {
  background-color: #f8f8f8;
}
</style>
</body>
</html>